setwd("D:/Fall 16/ADS/Git Repo Assignemnt 2- Team 7")
rd1 <-  read.csv("rawData1.csv",header = TRUE)
setwd("D:/Fall 16/ADS/Git Repo Assignemnt 2- Team 7/InputFiles")
rd1 <-  read.csv("rawData1.csv",header = TRUE)
rd2 <- read.csv("rawData2.csv",header = TRUE)
library(dplyr)
library(tidyr)
library(lubridate)
library(weatherData)
rd1 <-  filter(rd1, Units == "kWh",Channel  == "MILDRED SCHOOL 1")
rd2 <-  filter(rd2, Units == "kWh",Channel  == "MILDRED SCHOOL 1")
data <- rbind(rd1,rd2)
data$Date <- as.Date(data$Date,"%m/%d/%Y")
data$Channel <- as.character(data$Channel)
data$Units <- as.character(data$Units)
column_Pos <- grep("X",colnames(data))
columnnamesval <- grep("X",colnames(data),value = TRUE)
Data.long <- gather(data,key,values,column_Pos)
checkWeekday <- function(date){
a = if((wday(date) == 6 || wday(date) == 7)) 0 else 1
return(a)
}
aggData <- Data.long %>% group_by(Account,Date,Channel,Units) %>%
summarise('0' = sum(values[key %in% columnnamesval[1:12]]),
'1' = sum(values[key %in% columnnamesval[13:24]]),
'2' = sum(values[key %in% columnnamesval[25:36]]),
'3' = sum(values[key %in% columnnamesval[37:48]]),
'4'  = sum(values[key %in% columnnamesval[49:60]]),
'5' = sum(values[key %in% columnnamesval[61:72]]),
'6' = sum(values[key %in% columnnamesval[73:84]]),
'7' = sum(values[key %in% columnnamesval[85:96]]),
'8' = sum(values[key %in% columnnamesval[97:108]]),
'9' = sum(values[key %in% columnnamesval[109:120]]),
'10' = sum(values[key %in% columnnamesval[121:132]]),
'11' = sum(values[key %in% columnnamesval[133:144]]),
'12' = sum(values[key %in% columnnamesval[145:156]]),
'13' = sum(values[key %in% columnnamesval[157:168]]),
'14' = sum(values[key %in% columnnamesval[169:180]]),
'15' = sum(values[key %in% columnnamesval[181:192]]),
'16' = sum(values[key %in% columnnamesval[193:204]]),
'17' = sum(values[key %in% columnnamesval[205:216]]),
'18' = sum(values[key %in% columnnamesval[217:228]]),
'19' = sum(values[key %in% columnnamesval[229:240]]),
'20' = sum(values[key %in% columnnamesval[241:252]]),
'21' = sum(values[key %in% columnnamesval[253:264]]),
'22' = sum(values[key %in% columnnamesval[265:276]]),
'23' = sum(values[key %in% columnnamesval[277:288]])) %>%
mutate(month = lubridate::month(Date),day = day(Date),year = year(Date),'Day of Week' = wday(Date)) %>%
mutate(weekday = sapply(Date, function(x) checkWeekday(x)))
aggData.long <- gather(aggData,hour,Kwh,5:28)
aggData.long$hour <- as.numeric(aggData.long$hour)
cal_PeakHour <- function(hour){
p = if(hour > 6 & hour < 20) 1 else 0
return(p)
}
aggData.long$PeakHour <- sapply(aggData.long$hour,function(x)
aggData.long$PeakHour <- sapply(aggData.long$hour,function(x)
aggData.long$PeakHour <- sapply(aggData.long$hour,function(x) cal_PeakHour(x))
k
aggData.long$PeakHour <- sapply(aggData.long$hour,function(x) cal_PeakHour(x))
```
aggData.long$PeakHour <- sapply(aggData.long$hour,function(x) cal_PeakHour(x))
mindate <- as.Date(mindate, "%m/%d/%Y")
maxdate <- as.Date(maxdate, "%m/%d/%Y")
